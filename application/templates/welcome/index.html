{% extends "../layouts/layout.html" %}
{% block title %}Pixnet Album Maker{% endblock %}
{% block content %}
    <div id="head">
        <h1>Pixnet Album Maker</h1>
    </div>
    <div id="content">
        <form id="form1" action="/pixnet/albums">
            <fieldset>
                <p>
                    <label>Username:</label>
                    <input type="text" id="username" name="username" value=""/>
                </p>
                <p>
                    <input type="submit" id="submit" value="submit"/>
                    <input type="button" id="btn_show" value="Show album sets"/>
                </p>
            </fieldset>
        </form>
        <!-- this page is related to controller/welcome.py -->
        <div id="sets">
        </div>
        <div id="photos">
        </div>
    </div>
    <script id="albumSetTemplate" type="text/x-jquery-tmpl">
        <div class="set">
          <a href="javascript: showPhotos(${id});">
          <img src="${thumb}" alt="${title}"/><br/><span>${title}</span>
          </a>
        </div>
    </script>
    <script id="photoTemplate" type="text/x-jquery-tmpl">
        <div class="photo">
          <img src="${thumb}" alt="${title}"/><br/><span>${title}</span>
        </div>
    </script>
    <script type="text/javascript">
        $(document).ready( function() {
            $("#btn_show").click( function() {
                var jqxhr=$.getJSON("/pixnet/albums", 
                    {
                        'username': $("#username").val()
                    },
                function() {
                })
                .success( function(data) {
                    $( "#albumSetTemplate" ).tmpl( data )
                        .appendTo( "#sets" );
                } )
                .error( function() { alert("fail"); } );
            } );
        } );
        function showPhotos( id ) {
            var jqxhr=$.getJSON("/pixnet/photos", 
                {
                    'id': id,
                    'username': $("#username").val()
                },
            function() {
            })
            .success( function(data) {
                $( "#photoTemplate" ).tmpl( data )
                    .appendTo( "#photos" );
            } )
            .error( function() { alert("fail"); } );
        }
    </script>
{% endblock %}
